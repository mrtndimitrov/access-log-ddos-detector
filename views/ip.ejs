<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/bootstrap-css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link href="/css/styles.css" rel="stylesheet" crossorigin="anonymous">
    <title>DDOS detector</title>
</head>
<body>
<div class="container">
    <h1>Information about IP <%= ip %></h1>
    <hr>
    <div class="container">
        <div class="row">
            <div class="col-8">
                <div class="p-3 bg-body rounded shadow-sm">
                <iframe width="100%" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"
                        src="https://maps.google.com/maps?width=100%25&amp;height=600&amp;hl=en&amp;q=<%= geoData.latitude %>,<%= geoData.longitude %>&amp;t=&amp;z=6&amp;ie=UTF8&amp;iwloc=B&amp;output=embed"></iframe>
                </div>
            </div>
            <div class="col">
                <div class="p-3 bg-body rounded shadow-sm" style="min-height: 338px">
                    <h6 class="border-bottom pb-2 mb-0">Geo info</h6>
                    <div class="d-flex text-muted pt-3">
                        <img class="bd-placeholder-img flex-shrink-0 me-2 rounded" src="<%= geoData.location.country_flag %>" width="32" height="32">
                        <div class="pb-3 mb-0 small lh-sm border-bottom w-100">
                            <div class="d-flex justify-content-between">
                                <strong class="text-gray-dark"><%= geoData.country_name %></strong>
                                <span><%= geoData.country_code %></span>
                            </div>
                            <span class="d-block"><%= geoData.continent_name %></span>
                        </div>
                    </div>
                    <div class="d-flex text-muted pt-3">
                        <svg class="bd-placeholder-img flex-shrink-0 me-2 rounded" width="32" height="32" xmlns="http://www.w3.org/2000/svg" role="img" preserveAspectRatio="xMidYMid slice" focusable="false"><rect width="100%" height="100%" fill="#007bff"></rect></svg>
                        <div class="pb-3 mb-0 small lh-sm border-bottom w-100">
                            <div class="d-flex justify-content-between">
                                <strong class="text-gray-dark"><%= geoData.city %></strong>
                                <span><%= geoData.zip %></span>
                            </div>
                            <span class="d-block"><%= geoData.region_name %></span>
                        </div>
                    </div>
                    <div class="d-flex text-muted pt-3">
                        <svg class="bd-placeholder-img flex-shrink-0 me-2 rounded" width="32" height="32" xmlns="http://www.w3.org/2000/svg" role="img" preserveAspectRatio="xMidYMid slice" focusable="false"><rect width="100%" height="100%" fill="#e83e8c"></rect></svg>
                        <div class="pb-3 mb-0 small lh-sm border-bottom w-100">
                            <div class="d-flex justify-content-between">
                                <strong class="text-gray-dark">WhatIsMyIpAddress.com</strong>
                                <a href='https://whatismyipaddress.com/ip/<%= ip %>' target='_blank'>Check</a>
                            </div>
                            <span class="d-block">IP status service</span>
                        </div>
                    </div>
                    <div class="d-flex text-muted pt-3">
                        <svg class="bd-placeholder-img flex-shrink-0 me-2 rounded" width="32" height="32" xmlns="http://www.w3.org/2000/svg" role="img" preserveAspectRatio="xMidYMid slice" focusable="false"><rect width="100%" height="100%" fill="#6f42c1"></rect></svg>
                        <div class="pb-3 mb-0 small lh-sm border-bottom w-100">
                            <div class="d-flex justify-content-between">
                                <strong class="text-gray-dark">Project Honey Pot</strong>
                                <a href='https://www.projecthoneypot.org/ip_<%= ip %>' target='_blank'>Check</a>
                            </div>
                            <span class="d-block">IP spam checker</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <h4>TOTAL REQUESTS: <%= requests.length %></h4>
    <h4>TOTAL BYTES: <%= bytes %></h4>
    <hr>
    <table class="table table-sm caption-top fixed-height">
        <caption>Different status codes returned: <%= statusCodes.length %></caption>
        <thead>
        <tr>
            <th scope="col" class="sixty-percent">Status code</th>
            <th scope="col" class="forty-percent text-center">Number of times returned</th>
        </tr>
        </thead>
        <tbody>
        <%_ for(const statusCode of statusCodes) { _%>
        <tr>
            <th scope="row" class="sixty-percent"><%= statusCode[0] %></th>
            <td class="forty-percent"><%= statusCode[1] %></td>
        </tr>
        <%_ } _%>
        </tbody>
    </table>
    <table class="table table-sm caption-top fixed-height">
        <caption>Different user agents used: <%= userAgents.length %></caption>
        <thead>
        <tr>
            <th scope="col" class="sixty-percent">User agent</th>
            <th scope="col" class="forty-percent text-center">Number of times used</th>
        </tr>
        </thead>
        <tbody>
        <%_ for(const userAgent of userAgents) { _%>
            <tr>
                <th scope="row" class="sixty-percent"><%= userAgent[0] %></th>
                <td class="forty-percent"><%= userAgent[1] %></td>
            </tr>
        <%_ } _%>
        </tbody>
    </table>
    <table class="table table-sm caption-top fixed-height">
        <caption>Unique requests: <%= uniqueRequests.length %></caption>
        <thead>
        <tr>
            <th scope="col" class="seventy-percent">Request</th>
            <th scope="col" class="ten-percent text-center">Method</th>
            <th scope="col" class="ten-percent text-center">Status code</th>
            <th scope="col" class="ten-percent text-center">Number of times issued</th>
        </tr>
        </thead>
        <tbody>
        <%_ for(const uniqueRequest of uniqueRequests) { _%>
            <tr>
                <th scope="row" class="seventy-percent no-wrap" data-bs-toggle="tooltip" data-bs-placement="top" title="<%= uniqueRequest[1].request %>"><%= uniqueRequest[1].request %></th>
                <td class="ten-percent"><%= uniqueRequest[1].method %></td>
                <td class="ten-percent"><%= uniqueRequest[1].status %></td>
                <td class="ten-percent"><%= uniqueRequest[1].num %></td>
            </tr>
        <%_ } _%>
        </tbody>
    </table>
</div>
<script src="/bootstrap-js/bootstrap.bundle.js" crossorigin="anonymous"></script>
<script src="/chart-js/chart.js" crossorigin="anonymous"></script>
<script src="/js/script.js" crossorigin="anonymous"></script>
</body>
</html>
